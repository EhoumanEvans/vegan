
R version 3.3.1 (2016-06-21) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## test the stability of cca object and its support functions
> suppressPackageStartupMessages(require(vegan))
> set.seed(4711)
> ## models
> data(dune, dune.env)
> mcca <- cca(dune ~ Condition(Management) + Manure + A1, dune.env)
> mrda <- rda(dune ~ Condition(Management) + Manure + A1, dune.env)
> mrda1 <- rda(dune ~ Condition(Management) + Manure + A1, dune.env, scale=TRUE)
> mcap <- capscale(dune ~ Condition(Management) + Manure + A1, dune.env,
+           dist = "bray")
> mdb <- dbrda(dune ~ Condition(Management) + Manure + A1, dune.env,
+              dist = "bray")
> ## general appearance
> mcca
Call: cca(formula = dune ~ Condition(Management) + Manure + A1, data =
dune.env)

              Inertia Proportion Rank
Total          2.1153     1.0000     
Conditional    0.6038     0.2855    3
Constrained    0.4496     0.2126    4
Unconstrained  1.0618     0.5020   12
Inertia is mean squared contingency coefficient 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
   CCA1    CCA2    CCA3    CCA4 
0.22257 0.12260 0.06390 0.04055 

Eigenvalues for unconstrained axes:
   CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8    CA9   CA10   CA11 
0.3176 0.1586 0.1397 0.1161 0.0791 0.0753 0.0453 0.0402 0.0378 0.0280 0.0127 
  CA12 
0.0116 

> mrda
Call: rda(formula = dune ~ Condition(Management) + Manure + A1, data =
dune.env)

              Inertia Proportion Rank
Total         84.1237     1.0000     
Conditional   29.2307     0.3475    3
Constrained   16.7914     0.1996    4
Unconstrained 38.1016     0.4529   12
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4 
8.539 4.330 2.206 1.716 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9   PC10   PC11 
10.252  8.207  4.953  3.358  3.123  2.494  1.866  1.258  1.019  0.743  0.481 
  PC12 
 0.349 

> mcap
Call: capscale(formula = dune ~ Condition(Management) + Manure + A1,
data = dune.env, distance = "bray")

              Inertia Proportion Eigenvals Rank
Total          4.2990     1.0000    4.5939     
Conditional    1.4686     0.3416    1.5001    3
Constrained    1.0346     0.2407    1.0726    4
Unconstrained  1.7959     0.4177    2.0212   12
Imaginary                          -0.2949    5
Inertia is squared Bray distance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4 
0.6737 0.2430 0.1046 0.0514 

Eigenvalues for unconstrained axes:
  MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8   MDS9  MDS10  MDS11 
0.7489 0.3380 0.3084 0.2132 0.1370 0.1360 0.0620 0.0393 0.0169 0.0111 0.0065 
 MDS12 
0.0040 

> mdb
Call: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data
= dune.env, distance = "bray")

              Inertia Proportion Rank RealDims
Total          4.2990     1.0000              
Conditional    1.4686     0.3416    3         
Constrained    1.0346     0.2407    4        4
Unconstrained  1.7959     0.4177   12        9
Inertia is squared Bray distance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
dbRDA1 dbRDA2 dbRDA3 dbRDA4 
0.6666 0.2385 0.0910 0.0384 

Eigenvalues for unconstrained axes:
   MDS1    MDS2    MDS3    MDS4    MDS5    MDS6    MDS7    MDS8    MDS9   iMDS1 
 0.7420  0.3367  0.3066  0.2063  0.1334  0.1283  0.0398  0.0275  0.0004 -0.0199 
  iMDS2   iMDS3 
-0.0460 -0.0592 

> ## names
> sort(names(mcca))
 [1] "CA"          "CCA"         "call"        "colsum"      "grand.total"
 [6] "inertia"     "method"      "pCCA"        "rowsum"      "terminfo"   
[11] "terms"       "tot.chi"    
> sort(names(mrda))
 [1] "CA"          "CCA"         "call"        "colsum"      "grand.total"
 [6] "inertia"     "method"      "pCCA"        "rowsum"      "terminfo"   
[11] "terms"       "tot.chi"    
> sort(names(mcap))
 [1] "CA"           "CCA"          "adjust"       "call"         "colsum"      
 [6] "grand.total"  "inertia"      "method"       "pCCA"         "real.tot.chi"
[11] "rowsum"       "sqrt.dist"    "terminfo"     "terms"        "tot.chi"     
> sort(names(mdb))
 [1] "CA"        "CCA"       "adjust"    "call"      "colsum"    "inertia"  
 [7] "method"    "pCCA"      "sqrt.dist" "terminfo"  "terms"     "tot.chi"  
> ## overall results
> head(summary(mcca))

Call:
cca(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env) 

Partitioning of mean squared contingency coefficient:
              Inertia Proportion
Total          2.1153     1.0000
Conditioned    0.6038     0.2855
Constrained    0.4496     0.2126
Unconstrained  1.0618     0.5020

Eigenvalues, and their contribution to the mean squared contingency coefficient 
after removing the contribution of conditiniong variables

Importance of components:
                        CCA1    CCA2    CCA3    CCA4    CA1    CA2    CA3
Eigenvalue            0.2226 0.12260 0.06390 0.04055 0.3176 0.1586 0.1397
Proportion Explained  0.1473 0.08111 0.04228 0.02683 0.2101 0.1049 0.0924
Cumulative Proportion 0.1473 0.22837 0.27065 0.29748 0.5076 0.6125 0.7049
                         CA4     CA5     CA6     CA7     CA8     CA9    CA10
Eigenvalue            0.1161 0.07907 0.07534 0.04527 0.04018 0.03777 0.02799
Proportion Explained  0.0768 0.05232 0.04985 0.02996 0.02658 0.02499 0.01852
Cumulative Proportion 0.7817 0.83407 0.88391 0.91387 0.94045 0.96544 0.98396
                         CA11    CA12
Eigenvalue            0.01267 0.01158
Proportion Explained  0.00838 0.00766
Cumulative Proportion 0.99234 1.00000

Accumulated constrained eigenvalues
Importance of components:
                        CCA1   CCA2   CCA3    CCA4
Eigenvalue            0.2226 0.1226 0.0639 0.04055
Proportion Explained  0.4950 0.2727 0.1421 0.09019
Cumulative Proportion 0.4950 0.7677 0.9098 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions


Species scores

            CCA1     CCA2    CCA3     CCA4      CA1     CA2
Achimill -0.3020 -0.03039  0.1739 -0.29050 -0.47035  0.4053
Agrostol  0.4570 -0.06915 -0.1150  0.06489  0.46395 -0.2476
Airaprae -1.0449  0.77758 -0.2904 -0.23687 -2.44144 -1.1078
Alopgeni  0.2386  0.32932  0.1001 -0.03812  0.13379 -0.4529
Anthodor -0.3932  0.23278  0.1235 -0.03880 -1.20221  0.1624
Bellpere -0.4034 -0.53647  0.2775 -0.19005  0.02897  0.1588
....                                                       


Site scores (weighted averages of species scores)

         CCA1      CCA2    CCA3    CCA4      CA1      CA2
1    -1.96500 -2.647979 -1.6413  0.7526  0.16816  1.04046
2     0.01548 -0.648315  0.6587 -0.6812  0.65622 -1.25162
3    -0.71057 -0.840749  0.0553 -0.2768 -0.01137  0.02309
4    -0.87923 -1.474951 -0.3516  0.4807 -0.05715 -0.43671
5    -0.66004 -0.536002  1.6369 -0.9516 -0.64903  0.33149
6    -0.42088 -0.006203  1.8524 -1.2119  0.02111  1.12577
....                                                     


Site constraints (linear combinations of constraining variables)

        CCA1     CCA2    CCA3     CCA4      CA1      CA2
1    -1.5955 -0.99312 -0.5835  0.09984  0.16816  1.04046
2    -0.4818 -0.30770  1.2088 -1.78670  0.65622 -1.25162
3    -0.8519 -1.54647 -0.3768  0.26840 -0.01137  0.02309
4    -0.9014 -1.50958 -0.3906  0.25716 -0.05715 -0.43671
5     0.2849 -0.66306  1.6297  0.07742 -0.64903  0.33149
6    -0.7065  0.07475  1.3541 -0.14734  0.02111  1.12577
....                                                    


Biplot scores for constraining variables

             CCA1    CCA2     CCA3    CCA4 CA1 CA2
Manure.L -0.09246 -0.2777 -0.16360 -0.3007   0   0
Manure.Q -0.23596 -0.4065 -0.33840  0.1174   0   0
Manure.C -0.36444 -0.2344  0.09316  0.7255   0   0
A1        0.73608 -0.2785  0.41827  0.1096   0   0


Centroids for factor constraints

           CCA1    CCA2    CCA3    CCA4 CA1 CA2
Manure1  0.1028  0.3739 -0.6488  1.5695   0   0
Manure2 -0.2406  0.1422  1.5507 -0.3733   0   0
Manure3  0.9024  0.5482 -0.9689 -0.9932   0   0
Manure4 -1.0035 -1.4337 -0.4190  0.2340   0   0

> head(summary(mrda))

Call:
rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env) 

Partitioning of variance:
              Inertia Proportion
Total           84.12     1.0000
Conditioned     29.23     0.3475
Constrained     16.79     0.1996
Unconstrained   38.10     0.4529

Eigenvalues, and their contribution to the variance 
after removing the contribution of conditiniong variables

Importance of components:
                        RDA1    RDA2    RDA3    RDA4     PC1    PC2     PC3
Eigenvalue            8.5394 4.32972 2.20612 1.71619 10.2523 8.2069 4.95252
Proportion Explained  0.1556 0.07888 0.04019 0.03126  0.1868 0.1495 0.09022
Cumulative Proportion 0.1556 0.23444 0.27463 0.30589  0.4927 0.6422 0.73239
                          PC4     PC5     PC6     PC7     PC8     PC9    PC10
Eigenvalue            3.35769 3.12261 2.49407 1.86596 1.25786 1.01862 0.74284
Proportion Explained  0.06117 0.05689 0.04544 0.03399 0.02291 0.01856 0.01353
Cumulative Proportion 0.79356 0.85044 0.89588 0.92987 0.95279 0.97134 0.98487
                         PC11    PC12
Eigenvalue            0.48145 0.34882
Proportion Explained  0.00877 0.00635
Cumulative Proportion 0.99365 1.00000

Accumulated constrained eigenvalues
Importance of components:
                        RDA1   RDA2   RDA3   RDA4
Eigenvalue            8.5394 4.3297 2.2061 1.7162
Proportion Explained  0.5086 0.2579 0.1314 0.1022
Cumulative Proportion 0.5086 0.7664 0.8978 1.0000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  6.322924 


Species scores

             RDA1     RDA2      RDA3     RDA4      PC1      PC2
Achimill -0.14550  0.13153  0.130591 -0.18255 -0.29276 -0.06031
Agrostol  0.52375 -0.46961  0.054758  0.21830  1.01439  0.05307
Airaprae -0.08147  0.11025 -0.144870 -0.10175 -0.12976 -0.13252
Alopgeni  0.47459  0.21414 -0.004781 -0.04047  0.63179 -0.50591
Anthodor -0.15175  0.31064 -0.067197 -0.09460 -0.64397 -0.06438
Bellpere -0.27809  0.02717  0.245698 -0.05426  0.03467 -0.19891
....                                                           


Site scores (weighted sums of species scores)

       RDA1    RDA2    RDA3    RDA4     PC1     PC2
1    -3.402 -1.1290 -0.9821 -0.1855 -1.1005  1.2222
2    -0.142 -0.2142  2.7695 -0.2806  1.9422 -1.8707
3    -1.868 -0.4323  1.1228 -0.1835  0.2872 -0.8173
4    -1.755 -1.2670  0.6715  1.7718  0.8134 -0.4049
5    -0.778  2.0101  2.6716 -1.2709 -0.9906 -0.2655
6    -0.848  2.2170  2.0765 -1.0842 -1.3093  2.3704
....                                               


Site constraints (linear combinations of constraining variables)

         RDA1   RDA2    RDA3     RDA4     PC1     PC2
1    -2.61763 -0.569 -0.2204  0.12268 -1.1005  1.2222
2    -0.62199  1.011  2.3626 -2.44309  1.9422 -1.8707
3    -2.18907 -1.149  0.5417  0.65792  0.2872 -0.8173
4    -2.21764 -1.110  0.4909  0.62224  0.8134 -0.4049
5    -0.07305  1.172  2.3291  0.64921 -0.9906 -0.2655
6    -0.64445  1.946  1.3130 -0.06445 -1.3093  2.3704
....                                                 


Biplot scores for constraining variables

            RDA1    RDA2     RDA3    RDA4 PC1 PC2
Manure.L -0.2149 -0.2419  0.09302 -0.2225   0   0
Manure.Q -0.4401 -0.3373 -0.08826  0.1125   0   0
Manure.C -0.4646  0.1488 -0.09362  0.6665   0   0
A1        0.5201 -0.2136  0.60923  0.3502   0   0


Centroids for factor constraints

            RDA1    RDA2    RDA3    RDA4 PC1 PC2
Manure1  0.25589 -0.1299 -1.6158  1.9549   0   0
Manure2  0.05495  1.9587  1.6768 -0.3089   0   0
Manure3  1.50921 -1.1542 -0.6679 -1.5080   0   0
Manure4 -2.34145 -0.9428  0.2708  0.4676   0   0

> head(summary(mrda1))

Call:
rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env,      scale = TRUE) 

Partitioning of correlations:
              Inertia Proportion
Total          30.000     1.0000
Conditioned     8.780     0.2927
Constrained     6.141     0.2047
Unconstrained  15.079     0.5026

Eigenvalues, and their contribution to the correlations 
after removing the contribution of conditiniong variables

Importance of components:
                        RDA1    RDA2    RDA3    RDA4    PC1    PC2     PC3
Eigenvalue            2.6117 1.69906 1.10393 0.72605 3.4684 2.5471 2.11575
Proportion Explained  0.1231 0.08007 0.05202 0.03422 0.1635 0.1200 0.09971
Cumulative Proportion 0.1231 0.20315 0.25517 0.28939 0.4528 0.5729 0.67258
                          PC4     PC5     PC6     PC7     PC8     PC9    PC10
Eigenvalue            1.72233 1.44262 0.96108 0.80894 0.73780 0.49031 0.38048
Proportion Explained  0.08117 0.06799 0.04529 0.03812 0.03477 0.02311 0.01793
Cumulative Proportion 0.75375 0.82173 0.86703 0.90515 0.93992 0.96302 0.98095
                         PC11   PC12
Eigenvalue            0.24717 0.1570
Proportion Explained  0.01165 0.0074
Cumulative Proportion 0.99260 1.0000

Accumulated constrained eigenvalues
Importance of components:
                        RDA1   RDA2   RDA3   RDA4
Eigenvalue            2.6117 1.6991 1.1039 0.7261
Proportion Explained  0.4253 0.2767 0.1798 0.1182
Cumulative Proportion 0.4253 0.7020 0.8818 1.0000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  4.886172 


Species scores

            RDA1    RDA2     RDA3     RDA4      PC1      PC2
Achimill -0.2015  0.0240  0.15674 -0.17627  0.18039  0.27693
Agrostol  0.3092 -0.1517 -0.08093  0.04138 -0.38182 -0.27286
Airaprae -0.1885  0.2941 -0.08865 -0.07686  0.49477 -0.23646
Alopgeni  0.1979  0.1257  0.10439 -0.01677 -0.12026 -0.33195
Anthodor -0.1755  0.1933  0.09312 -0.01215  0.52322  0.20241
Bellpere -0.3524 -0.2243  0.18857 -0.09393  0.01088 -0.09491
....                                                        


Site scores (weighted sums of species scores)

        RDA1    RDA2      RDA3     RDA4      PC1     PC2
1    -1.4695 -0.7614 -1.171234  0.06443 -0.16939  1.2128
2    -0.4414 -1.0286  1.114025 -1.42116 -0.83505 -1.6447
3    -1.2767 -0.8366  0.004919 -0.11192  0.01951  0.1068
4    -1.8532 -1.6510 -0.635210  0.97258  0.14988 -1.3196
5    -1.1089 -0.2520  1.932064 -1.06386  0.67670  0.3455
6    -0.6971  0.4364  2.582649 -0.57390  0.21765  1.8887
....                                                    


Site constraints (linear combinations of constraining variables)

        RDA1    RDA2    RDA3     RDA4      PC1     PC2
1    -1.8332 -0.6149 -0.7416  0.18601 -0.16939  1.2128
2    -0.8742 -0.2751  1.6994 -2.00294 -0.83505 -1.6447
3    -1.3676 -1.3413 -0.5226  0.37587  0.01951  0.1068
4    -1.3986 -1.2929 -0.5372  0.36322  0.14988 -1.3196
5    -0.2379 -0.6507  1.9351  0.30032  0.67670  0.3455
6    -0.8587  0.3179  1.6431  0.04717  0.21765  1.8887
....                                                  


Biplot scores for constraining variables

            RDA1     RDA2     RDA3     RDA4 PC1 PC2
Manure.L -0.1739 -0.21917 -0.13309 -0.25862   0   0
Manure.Q -0.3302 -0.29212 -0.35204  0.09809   0   0
Manure.C -0.4113 -0.08236 -0.02067  0.71730   0   0
A1        0.5843 -0.52307  0.41469  0.15159   0   0


Centroids for factor constraints

           RDA1    RDA2    RDA3    RDA4 PC1 PC2
Manure1  0.3905  0.4160 -0.8928  1.6637   0   0
Manure2 -0.3631  0.2937  1.9393 -0.2230   0   0
Manure3  1.2201  0.2066 -0.8193 -1.2560   0   0
Manure4 -1.5331 -1.0830 -0.6005  0.3084   0   0

> head(summary(mcap))

Call:
capscale(formula = dune ~ Condition(Management) + Manure + A1,      data = dune.env, distance = "bray") 

Partitioning of squared Bray distance:
              Inertia Proportion
Total           4.594     1.0000
Conditioned     1.469     0.3197
Constrained     1.035     0.2252
Unconstrained   1.796     0.3909

Eigenvalues, and their contribution to the squared Bray distance 
after removing the contribution of conditiniong variables

Importance of components:
                        CAP1    CAP2   CAP3    CAP4   MDS1   MDS2    MDS3
Eigenvalue            0.6737 0.24300 0.1046 0.05136 0.7489 0.3380 0.30841
Proportion Explained  0.2178 0.07854 0.0338 0.01660 0.2421 0.1092 0.09969
Cumulative Proportion 0.2178 0.29630 0.3301 0.34670 0.5888 0.6980 0.79770
                        MDS4    MDS5    MDS6    MDS7    MDS8    MDS9   MDS10
Eigenvalue            0.2132 0.13698 0.13604 0.06196 0.03929 0.01687 0.01110
Proportion Explained  0.0689 0.04428 0.04397 0.02003 0.01270 0.00545 0.00359
Cumulative Proportion 0.8666 0.91088 0.95485 0.97487 0.98757 0.99303 0.99661
                         MDS11    MDS12
Eigenvalue            0.006462 0.004016
Proportion Explained  0.002090 0.001300
Cumulative Proportion 0.998700 1.000000

Accumulated constrained eigenvalues
Importance of components:
                        CAP1   CAP2    CAP3    CAP4
Eigenvalue            0.6737 0.2430 0.10457 0.05136
Proportion Explained  0.6281 0.2265 0.09749 0.04788
Cumulative Proportion 0.6281 0.8546 0.95212 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  3.00629 


Species scores

             CAP1     CAP2     CAP3      CAP4     MDS1      MDS2
Achimill -0.10723 -0.02762 -0.06497  0.061214 -0.18926  0.189295
Agrostol  0.38537  0.16664  0.06650 -0.031455  0.56724  0.002715
Airaprae -0.08164 -0.07543  0.03695  0.015634 -0.12521 -0.012439
Alopgeni  0.24656 -0.15983 -0.02564  0.022079  0.25760 -0.250870
Anthodor -0.13935 -0.13763 -0.03132  0.008705 -0.41826  0.137366
Bellpere -0.15065  0.06935 -0.09839  0.026235 -0.01959 -0.094694
....                                                            


Site scores (weighted sums of species scores)

         CAP1    CAP2    CAP3    CAP4     MDS1    MDS2
1    -1.75091  1.4325  0.9988 -0.1880 -0.28006  0.9259
2    -0.04337  0.6007 -1.0699  0.6351  0.57727  0.0195
3    -0.46252  0.4417 -0.7228 -0.3457  0.11120 -0.4459
4    -0.57266  0.4128 -0.2832 -0.2175  0.16886 -0.4800
5    -0.61137 -0.4570 -1.4115  1.1267 -0.69415  0.1504
6    -0.35926 -0.4786 -1.0118  0.7461 -0.05716  0.4106
....                                                  


Site constraints (linear combinations of constraining variables)

         CAP1     CAP2     CAP3     CAP4     MDS1    MDS2
1    -1.14568  0.52204  0.13998 -0.17847 -0.28006  0.9259
2    -0.41299 -0.08520 -1.05218  1.28256  0.57727  0.0195
3    -0.80898  0.89489 -0.08091 -0.29002  0.11120 -0.4459
4    -0.83143  0.87003 -0.06619 -0.28258  0.16886 -0.4800
5     0.05176  0.02045 -1.27141 -0.11767 -0.69415  0.1504
6    -0.39716 -0.47668 -0.97690  0.03106 -0.05716  0.4106
....                                                     


Biplot scores for constraining variables

            CAP1    CAP2     CAP3    CAP4 MDS1 MDS2
Manure.L -0.1818 0.26436  0.04782  0.2401    0    0
Manure.Q -0.3503 0.38834  0.18993 -0.1354    0    0
Manure.C -0.3820 0.06479 -0.10533 -0.7278    0    0
A1        0.6755 0.35212 -0.46328 -0.1227    0    0


Centroids for factor constraints

            CAP1    CAP2      CAP3    CAP4 MDS1 MDS2
Manure1  0.17436 -0.1293  0.575731 -1.0461    0    0
Manure2 -0.07502 -0.5180 -1.097593  0.2154    0    0
Manure3  0.64077  0.0433  0.667576  0.7569    0    0
Manure4 -0.92870  0.7623 -0.002374 -0.2504    0    0

> head(summary(mdb))

Call:
dbrda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env,      distance = "bray") 

Partitioning of squared Bray distance:
              Inertia Proportion
Total           4.299     1.0000
Conditioned     1.469     0.3416
Constrained     1.035     0.2407
Unconstrained   1.796     0.4177

Eigenvalues, and their contribution to the squared Bray distance 
after removing the contribution of conditiniong variables

Importance of components:
                      dbRDA1  dbRDA2  dbRDA3  dbRDA4   MDS1   MDS2   MDS3
Eigenvalue            0.6666 0.23850 0.09102 0.03844 0.7420 0.3367 0.3066
Proportion Explained  0.2355 0.08426 0.03216 0.01358 0.2622 0.1190 0.1083
Cumulative Proportion     NA      NA      NA      NA     NA     NA     NA
                         MDS4    MDS5    MDS6    MDS7    MDS8      MDS9
Eigenvalue            0.20627 0.13339 0.12829 0.03980 0.02745 0.0004132
Proportion Explained  0.07288 0.04713 0.04533 0.01406 0.00970 0.0001500
Cumulative Proportion      NA      NA      NA      NA      NA        NA
                         iMDS1    iMDS2    iMDS3
Eigenvalue            -0.01985 -0.04601 -0.05923
Proportion Explained   0.00701  0.01626  0.02093
Cumulative Proportion       NA       NA       NA

Accumulated constrained eigenvalues
Importance of components:
                      dbRDA1 dbRDA2  dbRDA3  dbRDA4
Eigenvalue            0.6666 0.2385 0.09102 0.03844
Proportion Explained  0.6443 0.2305 0.08798 0.03716
Cumulative Proportion 0.6443 0.8749 0.96284 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  3.00629 


Species scores

     dbRDA1 dbRDA2 dbRDA3 dbRDA4 MDS1 MDS2
spe1                                      


Site scores (weighted sums of species scores)

       dbRDA1  dbRDA2  dbRDA3   dbRDA4     MDS1     MDS2
1    -1.78665 -1.5160 -1.5583 -1.09080 -0.25833  0.92271
2    -0.01705 -0.6581  0.9301  0.28816  0.57516  0.05239
3    -0.44007 -0.3970  1.1270  0.21113  0.09235 -0.44842
4    -0.54915 -0.3741  0.4416  0.09204  0.16597 -0.47429
5    -0.66299  0.3274  1.2512  2.07857 -0.69303  0.11522
6    -0.34304  0.4884  1.1823  1.87243 -0.05482  0.40479
....                                                    


Site constraints (linear combinations of constraining variables)

       dbRDA1    dbRDA2   dbRDA3   dbRDA4     MDS1     MDS2
1    -1.14324 -0.517750 -0.13719 -0.20653 -0.25833  0.92271
2    -0.40891  0.006731  0.84283  1.43257  0.57516  0.05239
3    -0.80504 -0.897322  0.08099 -0.29345  0.09235 -0.44842
4    -0.82758 -0.872017  0.06645 -0.28765  0.16597 -0.47429
5     0.05034 -0.082513  1.27197  0.07874 -0.69303  0.11522
6    -0.40060  0.423583  0.98106  0.19462 -0.05482  0.40479
....                                                       


Biplot scores for constraining variables

          dbRDA1   dbRDA2   dbRDA3   dbRDA4 MDS1 MDS2
Manure.L -0.1792 -0.26684 -0.09723  0.22382    0    0
Manure.Q -0.3484 -0.37781 -0.18544 -0.17142    0    0
Manure.C -0.3848 -0.05946  0.21300 -0.70283    0    0
A1        0.6766 -0.36898  0.46068 -0.06145    0    0


Centroids for factor constraints

          dbRDA1   dbRDA2    dbRDA3  dbRDA4 MDS1 MDS2
Manure1  0.16965  0.17776 -0.399584 -1.1193    0    0
Manure2 -0.07803  0.45741  1.074105  0.3951    0    0
Manure3  0.64476 -0.01896 -0.776980  0.6413    0    0
Manure4 -0.92529 -0.76236  0.003417 -0.2625    0    0

> 
> ## diagnostics
> 
> head(goodness(mcca, display = "sites"))
        CCA1       CCA2      CCA3      CCA4
1 0.19439838 0.23588790 0.2433538 0.2434925
2 0.03299646 0.04040925 0.1000429 0.1827178
3 0.11775497 0.33151525 0.3381310 0.3402609
4 0.11813758 0.30062627 0.3069950 0.3087468
5 0.01671515 0.06657670 0.2235774 0.2238022
6 0.10138789 0.10201299 0.2089372 0.2097406
> head(goodness(mrda, display = "sites"))
          RDA1       RDA2      RDA3      RDA4
1 0.3042523546 0.31154242 0.3120994 0.3122337
2 0.0169789662 0.03974561 0.1030337 0.1556786
3 0.2713407998 0.30924493 0.3135378 0.3184637
4 0.2436309283 0.27459862 0.2776830 0.2815378
5 0.0003938931 0.05183257 0.1552911 0.1615442
6 0.0230811272 0.12974351 0.1544944 0.1545408
> head(goodness(mrda1, display = "sites"))
         RDA1       RDA2      RDA3      RDA4
1 0.269516930 0.28924298 0.3078897 0.3086611
2 0.049296095 0.05247303 0.1312267 0.2031754
3 0.187662834 0.30509839 0.3166831 0.3206240
4 0.128367393 0.19972542 0.2077312 0.2101379
5 0.006035161 0.03540179 0.2041641 0.2068374
6 0.062654657 0.06824120 0.1652197 0.1652722
> head(goodness(mcap, display = "sites"))
         CAP1        CAP2      CAP3      CAP4
1 0.364404730 0.391694519 0.3925389 0.3932130
2 0.059800207 0.060718087 0.1209687 0.1649362
3 0.289145392 0.416762338 0.4172113 0.4200443
4 0.274122521 0.382389905 0.3826596 0.3850735
5 0.001394287 0.001472804 0.1320512 0.1326006
6 0.084370100 0.128207962 0.2074427 0.2074821
> head(goodness(mdb, display="sites"))
       dbRDA1      dbRDA2    dbRDA3    dbRDA4
1 0.396671569 0.425779733 0.4265597 0.4273063
2 0.063301633 0.063307769 0.1000293 0.1448339
3 0.313900133 0.453432500 0.4538663 0.4562716
4 0.278039539 0.388485832 0.3887306 0.3906677
5 0.001529465 0.002999705 0.1363394 0.1365552
6 0.098574729 0.138006316 0.2187338 0.2200755
> 
> head(inertcomp(mcca))
                pCCA         CCA         CA
Achimill 0.015342931 0.004830244 0.03052901
Agrostol 0.038101789 0.016193872 0.02781563
Airaprae 0.025813313 0.013407926 0.06487734
Alopgeni 0.048789228 0.009296210 0.03712116
Anthodor 0.014146632 0.006915015 0.07278055
Bellpere 0.006973897 0.010696508 0.02007220
> head(inertcomp(mrda))
              pCCA       CCA        CA
Achimill 0.6087719 0.1869589 0.7411113
Agrostol 2.8122807 1.1478207 3.2398986
Airaprae 0.1535088 0.1054888 0.3594234
Alopgeni 3.2631579 0.5739140 3.0681912
Anthodor 0.5342105 0.2798317 2.0780630
Bellpere 0.2114035 0.2974938 0.5726817
> head(inertcomp(mrda1))
              pCCA        CCA        CA
Achimill 0.3961187 0.12165131 0.4822300
Agrostol 0.3905945 0.15941954 0.4499859
Airaprae 0.2482270 0.17057771 0.5811953
Alopgeni 0.4725610 0.08311255 0.4443265
Anthodor 0.1847134 0.09675710 0.7185295
Bellpere 0.1954582 0.27505507 0.5294867
> head(inertcomp(mcap, display="sites"))
        pCCA        CCA         CA
1 0.05862797 0.10557750 0.10429404
2 0.10040531 0.03506727 0.07713851
3 0.05862797 0.07087019 0.03922261
4 0.05862797 0.07238613 0.05696591
5 0.04347384 0.01899383 0.08077329
6 0.04347384 0.02891520 0.06697336
> head(inertcomp(mdb, display = "sites"))
        pCCA        CCA         CA
1 0.05838308 0.10384563 0.08079518
2 0.09331841 0.02821768 0.07329175
3 0.05838308 0.06948145 0.02441639
4 0.05838308 0.07097906 0.05232441
5 0.04226830 0.01668742 0.06324705
6 0.04226830 0.02642583 0.05138205
> 
> zapsmall(intersetcor(mcca))
                   CCA1       CCA2       CCA3       CCA4
ManagementHF -0.0001934 -0.0007992 -0.0010906  0.0006051
ManagementNM  0.0002753  0.0011379  0.0015528 -0.0008616
ManagementSF  0.0000095  0.0000395  0.0000539 -0.0000299
Manure.L     -0.0733893 -0.2393186 -0.1243256 -0.2126245
Manure.Q     -0.1839348 -0.3480167 -0.2558186  0.0825320
Manure.C     -0.2865120 -0.2018253  0.0703289  0.5143306
Manure^4     -0.2702318 -0.1604848  0.6766542 -0.1341245
A1            0.5782682 -0.2385266  0.3171928  0.0773307
> zapsmall(intersetcor(mrda))
                   RDA1       RDA2       RDA3       RDA4
ManagementHF  0.0000000  0.0000000  0.0000000  0.0000000
ManagementNM  0.0000000  0.0000000  0.0000000  0.0000000
ManagementSF  0.0000000  0.0000000  0.0000000  0.0000000
Manure.L     -0.1814866 -0.1833436  0.0688183 -0.1685000
Manure.Q     -0.3716830 -0.2556442 -0.0652969  0.0852062
Manure.C     -0.3923337  0.1127663 -0.0692608  0.5046733
Manure^4     -0.2707780  0.4738701  0.5124789 -0.0393923
A1            0.4392760 -0.1618521  0.4507210  0.2651417
> zapsmall(intersetcor(mrda1))
                   RDA1       RDA2       RDA3       RDA4
ManagementHF  0.0000000  0.0000000  0.0000000  0.0000000
ManagementNM  0.0000000  0.0000000  0.0000000  0.0000000
ManagementSF  0.0000000  0.0000000  0.0000000  0.0000000
Manure.L     -0.1440753 -0.1789975 -0.1056852 -0.2024219
Manure.Q     -0.2735856 -0.2385795 -0.2795427  0.0767754
Manure.C     -0.3407875 -0.0672647 -0.0164099  0.5614188
Manure^4     -0.3917467 -0.0462905  0.6861259 -0.0423753
A1            0.4840744 -0.4272000  0.3292941  0.1186471
> zapsmall(intersetcor(mcap))
                   CAP1       CAP2       CAP3       CAP4
ManagementHF  0.0000000  0.0000000  0.0000000  0.0000000
ManagementNM  0.0000000  0.0000000  0.0000000  0.0000000
ManagementSF  0.0000000  0.0000000  0.0000000  0.0000000
Manure.L     -0.1389432  0.1892092  0.0325955  0.1333797
Manure.Q     -0.2676678  0.2779449  0.1294648 -0.0752298
Manure.C     -0.2918733  0.0463725 -0.0718000 -0.4043456
Manure^4     -0.2649837 -0.1361457 -0.6134655  0.0553251
A1            0.5161159  0.2520227 -0.3157993 -0.0681834
> zapsmall(intersetcor(mdb))
                 dbRDA1     dbRDA2     dbRDA3     dbRDA4
ManagementHF  0.0000000  0.0000000  0.0000000  0.0000000
ManagementNM  0.0000000  0.0000000  0.0000000  0.0000000
ManagementSF  0.0000000  0.0000000  0.0000000  0.0000000
Manure.L     -0.1357474 -0.1892798 -0.0587269  0.0793808
Manure.Q     -0.2639013 -0.2679963 -0.1120040 -0.0607987
Manure.C     -0.2914039 -0.0421806  0.1286504 -0.2492729
Manure^4     -0.2637197  0.0996818  0.5321555  0.0862005
A1            0.5124254 -0.2617333  0.2782520 -0.0217933
> 
> tolerance(mcca)

	Species Tolerances

Scaling: 2

              CCA1       CCA2
Achimill 0.7502275  0.7157100
Agrostol 1.2853383  1.1570061
Airaprae       NaN 11.5634285
Alopgeni 1.0273044  1.0055154
Anthodor 0.9668769  0.5098809
Bellpere       NaN        NaN
Bromhord 0.8311660  0.6685054
Chenalbu 2.7043082  2.3500218
Cirsarve 2.4895294  3.2726524
Comapalu       NaN  5.7190733
Eleopalu 1.9046374  1.3237573
Elymrepe 0.1542189  0.1078939
Empenigr 0.5787202  2.2381007
Hyporadi 1.8124576        NaN
Juncarti 1.2921393  1.2932744
Juncbufo       NaN        NaN
Lolipere 0.6907463  0.6909286
Planlanc 0.7978280  0.7455048
Poaprat  0.7789834  0.7826129
Poatriv  0.9790234  0.9780299
Ranuflam 1.2766000  1.1590746
Rumeacet 1.1430153  1.0478752
Sagiproc 1.1506476  0.9598708
Salirepe 2.1948038        NaN
Scorautu 0.9516102  0.9365612
Trifprat 0.5868068  0.6204464
Trifrepe 1.0692801  1.0389263
Vicilath 1.9008962  2.0758904
Bracruta 1.0491579  1.0252364
Callcusp 0.2652331  0.5049434

Warning message:
In sqrt(sweep(colSums(sweep(xiuk[, 2, , choices]^2, c(1:2), data.matrix(Y),  :
  NaNs produced
> 
> vif.cca(mcca)
ManagementHF ManagementNM ManagementSF     Manure.L     Manure.Q     Manure.C 
    2.639215    59.435289     4.692185    29.462082    20.057970     7.009516 
    Manure^4           A1 
          NA     1.432399 
> vif.cca(mrda)
ManagementHF ManagementNM ManagementSF     Manure.L     Manure.Q     Manure.C 
    2.760761    82.079142     5.063112    38.480844    24.068480     7.468851 
    Manure^4           A1 
          NA     1.391558 
> vif.cca(mcap)
ManagementHF ManagementNM ManagementSF     Manure.L     Manure.Q     Manure.C 
    2.760761    82.079142     5.063112    38.480844    24.068480     7.468851 
    Manure^4           A1 
          NA     1.391558 
> vif.cca(mdb)
ManagementHF ManagementNM ManagementSF     Manure.L     Manure.Q     Manure.C 
    2.760761    82.079142     5.063112    38.480844    24.068480     7.468851 
    Manure^4           A1 
          NA     1.391558 
> 
> alias(mcca)
Model :
dune ~ Condition(Management) + Manure + A1

Complete :
         ManagementHF ManagementNM ManagementSF Manure.L  Manure.Q  Manure.C 
Manure^4               8.366600                  5.291503 -4.472136  2.645751
         A1
Manure^4   

> alias(mrda)
Model :
dune ~ Condition(Management) + Manure + A1

Complete :
         ManagementHF ManagementNM ManagementSF Manure.L  Manure.Q  Manure.C 
Manure^4               8.366600                  5.291503 -4.472136  2.645751
         A1
Manure^4   

> alias(mcap)
Model :
dune ~ Condition(Management) + Manure + A1

Complete :
         ManagementHF ManagementNM ManagementSF Manure.L  Manure.Q  Manure.C 
Manure^4               8.366600                  5.291503 -4.472136  2.645751
         A1
Manure^4   

> alias(mdb)
Model :
dune ~ Condition(Management) + Manure + A1

Complete :
         ManagementHF ManagementNM ManagementSF Manure.L  Manure.Q  Manure.C 
Manure^4               8.366600                  5.291503 -4.472136  2.645751
         A1
Manure^4   

> 
> ## basic statistic
> 
> coef(mcca)
                    CCA1        CCA2        CCA3       CCA4
ManagementHF  -0.6212928  0.67756808  0.03503462  1.5494639
ManagementNM -10.0121670 -2.63701149 14.10491529 -5.4155774
ManagementSF  -0.6160467  2.92012729  0.60781633  1.9872587
Manure.L      -5.7597904 -5.15119598  8.20328396 -5.6214078
Manure.Q       4.2747761 -0.01096574 -8.39627202  3.2306374
Manure.C      -3.4080262 -1.87888597  4.69303630  0.2515154
Manure^4              NA          NA          NA         NA
A1             0.4957227 -0.36890198  0.13779157  0.1123764
> coef(mrda)
                    RDA1        RDA2        RDA3        RDA4
ManagementHF -0.03970067  0.19665399 -0.23028304  0.33104446
ManagementNM -1.88561571  2.73318775  2.66184398 -0.96507906
ManagementSF  0.24105606  0.56671797 -0.44738020  0.35507245
Manure.L     -1.50267801  1.05717457  2.21253094 -0.97263359
Manure.Q      0.62741024 -1.68077955 -1.47294674  0.60565968
Manure.C     -0.77601600  0.84976951  0.85520077  0.18306231
Manure^4              NA          NA          NA          NA
A1            0.04518551 -0.06115177  0.08035078  0.05643429
> coef(mrda1)
                    RDA1        RDA2        RDA3        RDA4
ManagementHF -0.04764686  0.20065792 -0.03542759  0.39884923
ManagementNM -2.60912073  0.06711382  3.39320623 -0.84663396
ManagementSF  0.13890313  0.64911093  0.09094389  0.50654999
Manure.L     -1.83207568 -0.74446530  2.03604271 -1.07738978
Manure.Q      1.09076910 -0.25309084 -2.05244911  0.53728921
Manure.C     -0.94262131 -0.14740666  1.06517010  0.21056637
Manure^4              NA          NA          NA          NA
A1            0.06352064 -0.09911359  0.02988122  0.02590529
> coef(mcap)
                    CAP1       CAP2        CAP3       CAP4
ManagementHF -0.05446430 -0.1963686  0.06423011 -0.3965062
ManagementNM -2.14431921 -0.9759953 -3.53060838  1.0133043
ManagementSF  0.11809570 -0.6710184  0.10012402 -0.4809009
Manure.L     -1.51055399  0.1933911 -2.36041731  1.1516185
Manure.Q      0.83159366  0.8045706  1.99715767 -0.6538643
Manure.C     -0.76906793 -0.1630122 -1.20182259 -0.1636253
Manure^4              NA         NA          NA         NA
A1            0.07466365  0.0826825 -0.04898362 -0.0247365
> coef(mdb)
                  dbRDA1     dbRDA2       dbRDA3      dbRDA4
ManagementHF -0.05723350  0.2059983  0.007271835 -0.39636572
ManagementNM -2.14856017  0.7651671  3.369400423  1.57734022
ManagementSF  0.11222605  0.6842717  0.007712919 -0.47394178
Manure.L     -1.50644728 -0.3419042  2.138959205  1.50184559
Manure.Q      0.83513374 -0.6857571 -1.906088364 -0.97681891
Manure.C     -0.77167591  0.1002141  1.217675445  0.03048179
Manure^4              NA         NA           NA          NA
A1            0.07499906 -0.0841729  0.048383354 -0.01927336
> 
> eigenvals(mcca)
     CCA1      CCA2      CCA3      CCA4       CA1       CA2       CA3       CA4 
0.2225695 0.1225962 0.0639014 0.0405522 0.3176118 0.1585838 0.1396622 0.1160800 
      CA5       CA6       CA7       CA8       CA9      CA10      CA11      CA12 
0.0790722 0.0753401 0.0452749 0.0401788 0.0377668 0.0279878 0.0126652 0.0115828 
> eigenvals(mrda)
     RDA1      RDA2      RDA3      RDA4       PC1       PC2       PC3       PC4 
 8.539376  4.329719  2.206120  1.716188 10.252251  8.206887  4.952520  3.357695 
      PC5       PC6       PC7       PC8       PC9      PC10      PC11      PC12 
 3.122610  2.494065  1.865957  1.257864  1.018620  0.742838  0.481450  0.348822 
> eigenvals(mrda1)
    RDA1     RDA2     RDA3     RDA4      PC1      PC2      PC3      PC4 
2.611677 1.699061 1.103932 0.726054 3.468373 2.547106 2.115753 1.722328 
     PC5      PC6      PC7      PC8      PC9     PC10     PC11     PC12 
1.442621 0.961082 0.808945 0.737802 0.490311 0.380476 0.247170 0.156976 
> eigenvals(mcap)
     CAP1      CAP2      CAP3      CAP4      MDS1      MDS2      MDS3      MDS4 
0.6736989 0.2429955 0.1045745 0.0513599 0.7489447 0.3379553 0.3084136 0.2131612 
     MDS5      MDS6      MDS7      MDS8      MDS9     MDS10     MDS11     MDS12 
0.1369797 0.1360369 0.0619562 0.0392880 0.0168713 0.0110954 0.0064619 0.0040164 
> eigenvals(mdb)
    dbRDA1     dbRDA2     dbRDA3     dbRDA4       MDS1       MDS2       MDS3 
 0.6666007  0.2384984  0.0910230  0.0384419  0.7420377  0.3366825  0.3066214 
      MDS4       MDS5       MDS6       MDS7       MDS8       MDS9      iMDS1 
 0.2062738  0.1333917  0.1282900  0.0398034  0.0274501  0.0004132 -0.0198542 
     iMDS2      iMDS3 
-0.0460150 -0.0592284 
> 
> nobs(mcca)
[1] 20
> nobs(mrda)
[1] 20
> nobs(mcap)
[1] 20
> nobs(mdb)
[1] 20
> 
> RsquareAdj(mcca)
$r.squared
[1] 0.2125594

$adj.r.squared
[1] 0.07369434

> RsquareAdj(mrda)
$r.squared
[1] 0.1996037

$adj.r.squared
[1] 0.0577473

> RsquareAdj(mrda1)
$r.squared
[1] 0.2046908

$adj.r.squared
[1] 0.04411202

> RsquareAdj(mcap)
$r.squared
[1] 0.240651

$adj.r.squared
[1] 0.1204183

> RsquareAdj(mdb)
$r.squared
[1] 0.240651

$adj.r.squared
[1] 0.1204183

> 
> ## casting
> 
> as.mlm(mcca)

Call:
lm(formula = wa ~ . - 1, data = as.data.frame(X))

Coefficients:
              CCA1       CCA2       CCA3       CCA4     
ManagementHF   -0.62129    0.67757    0.03503    1.54946
ManagementNM  -10.01217   -2.63701   14.10492   -5.41558
ManagementSF   -0.61605    2.92013    0.60782    1.98726
Manure.L       -5.75979   -5.15120    8.20328   -5.62141
Manure.Q        4.27478   -0.01097   -8.39627    3.23064
Manure.C       -3.40803   -1.87889    4.69304    0.25152
`Manure^4`           NA         NA         NA         NA
A1              0.49572   -0.36890    0.13779    0.11238

> as.mlm(mrda)

Call:
lm(formula = x$CCA$wa ~ . - 1, data = as.data.frame(X))

Coefficients:
              RDA1      RDA2      RDA3      RDA4    
ManagementHF  -0.03970   0.19665  -0.23028   0.33104
ManagementNM  -1.88562   2.73319   2.66184  -0.96508
ManagementSF   0.24106   0.56672  -0.44738   0.35507
Manure.L      -1.50268   1.05717   2.21253  -0.97263
Manure.Q       0.62741  -1.68078  -1.47295   0.60566
Manure.C      -0.77602   0.84977   0.85520   0.18306
`Manure^4`          NA        NA        NA        NA
A1             0.04519  -0.06115   0.08035   0.05643

> as.mlm(mrda1)

Call:
lm(formula = x$CCA$wa ~ . - 1, data = as.data.frame(X))

Coefficients:
              RDA1      RDA2      RDA3      RDA4    
ManagementHF  -0.04765   0.20066  -0.03543   0.39885
ManagementNM  -2.60912   0.06711   3.39321  -0.84663
ManagementSF   0.13890   0.64911   0.09094   0.50655
Manure.L      -1.83208  -0.74447   2.03604  -1.07739
Manure.Q       1.09077  -0.25309  -2.05245   0.53729
Manure.C      -0.94262  -0.14741   1.06517   0.21057
`Manure^4`          NA        NA        NA        NA
A1             0.06352  -0.09911   0.02988   0.02591

> as.mlm(mcap)

Call:
lm(formula = x$CCA$wa ~ . - 1, data = as.data.frame(X))

Coefficients:
              CAP1      CAP2      CAP3      CAP4    
ManagementHF  -0.05446  -0.19637   0.06423  -0.39651
ManagementNM  -2.14432  -0.97600  -3.53061   1.01330
ManagementSF   0.11810  -0.67102   0.10012  -0.48090
Manure.L      -1.51055   0.19339  -2.36042   1.15162
Manure.Q       0.83159   0.80457   1.99716  -0.65386
Manure.C      -0.76907  -0.16301  -1.20182  -0.16363
`Manure^4`          NA        NA        NA        NA
A1             0.07466   0.08268  -0.04898  -0.02474

> as.mlm(mdb)

Call:
lm(formula = x$CCA$wa ~ . - 1, data = as.data.frame(X))

Coefficients:
              dbRDA1     dbRDA2     dbRDA3     dbRDA4   
ManagementHF  -0.057234   0.205998   0.007272  -0.396366
ManagementNM  -2.148560   0.765167   3.369400   1.577340
ManagementSF   0.112226   0.684272   0.007713  -0.473942
Manure.L      -1.506447  -0.341904   2.138959   1.501846
Manure.Q       0.835134  -0.685757  -1.906088  -0.976819
Manure.C      -0.771676   0.100214   1.217675   0.030482
`Manure^4`           NA         NA         NA         NA
A1             0.074999  -0.084173   0.048383  -0.019273

> 
> head(model.frame(mcca))
  Management Manure  A1
1         SF      4 2.8
2         BF      2 3.5
3         SF      4 4.3
4         SF      4 4.2
5         HF      2 6.3
6         HF      2 4.3
> head(model.frame(mrda))
  Management Manure  A1
1         SF      4 2.8
2         BF      2 3.5
3         SF      4 4.3
4         SF      4 4.2
5         HF      2 6.3
6         HF      2 4.3
> head(model.frame(mrda1))
  Management Manure  A1
1         SF      4 2.8
2         BF      2 3.5
3         SF      4 4.3
4         SF      4 4.2
5         HF      2 6.3
6         HF      2 4.3
> head(model.frame(mcap))
  Management Manure  A1
1         SF      4 2.8
2         BF      2 3.5
3         SF      4 4.3
4         SF      4 4.2
5         HF      2 6.3
6         HF      2 4.3
> head(model.frame(mdb))
  Management Manure  A1
1         SF      4 2.8
2         BF      2 3.5
3         SF      4 4.3
4         SF      4 4.2
5         HF      2 6.3
6         HF      2 4.3
> 
> ## testing and model building -
> 
> deviance(mcca)
[1] 727.3374
> deviance(mrda)
[1] 723.93
> deviance(mrda1)
[1] 286.4999
> deviance(mcap)
[1] 34.12146
> deviance(mdb)
[1] 34.12146
> 
> per <- shuffleSet(nrow(dune), 49)
> permutest(mcca, per)

Permutation test for cca 

Permutation: free
Number of permutations: 49
 
Call: cca(formula = dune ~ Condition(Management) + Manure + A1, data =
dune.env)
Permutation test for all constrained eigenvalues
Pseudo-F:	 1.270342 (with 4, 12 Degrees of Freedom)
Significance:	 0.14 

> permutest(mrda, per)

Permutation test for rda 

Permutation: free
Number of permutations: 49
 
Call: rda(formula = dune ~ Condition(Management) + Manure + A1, data =
dune.env)
Permutation test for all constrained eigenvalues
Pseudo-F:	 1.322103 (with 4, 12 Degrees of Freedom)
Significance:	 0.12 

> permutest(mrda1, per)

Permutation test for rda 

Permutation: free
Number of permutations: 49
 
Call: rda(formula = dune ~ Condition(Management) + Manure + A1, data =
dune.env, scale = TRUE)
Permutation test for all constrained eigenvalues
Pseudo-F:	 1.221715 (with 4, 12 Degrees of Freedom)
Significance:	 0.14 

> permutest(mcap, per)

Permutation test for capscale 

Permutation: free
Number of permutations: 49
 
Call: capscale(formula = dune ~ Condition(Management) + Manure + A1,
data = dune.env, distance = "bray")
Permutation test for all constrained eigenvalues
Pseudo-F:	 1.728242 (with 4, 12 Degrees of Freedom)
Significance:	 0.08 

> permutest(mdb, per)

Permutation test for dbrda 

Permutation: free
Number of permutations: 49
 
Call: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data
= dune.env, distance = "bray")
Permutation test for all constrained eigenvalues
Pseudo-F:	 1.728242 (with 4, 12 Degrees of Freedom)
Significance:	 0.08 

> 
> drop1(mcca, test="permutation", permutations=per)
                      Df    AIC      F Pr(>F)  
<none>                   87.873                
Condition(Management)  2 87.896                
Manure                 3 86.460 1.0310   0.38  
A1                     1 88.954 1.9983   0.04 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> drop1(mrda, test="permutation", permutations=per)
                      Df    AIC      F Pr(>F)
<none>                   87.779              
Condition(Management)  2 89.151              
Manure                 3 87.424 1.3043   0.16
A1                     1 87.517 1.0892   0.38
> drop1(mrda1, test="permutation", permutations=per)
                      Df    AIC     F Pr(>F)
<none>                   69.240             
Condition(Management)  2 69.817             
Manure                 3 68.166 1.117    0.3
A1                     1 69.568 1.481    0.1
> drop1(mcap, test="permutation", permutations=per)
                      Df    AIC      F Pr(>F)  
<none>                   26.684                
Condition(Management)  2 27.240                
Manure                 3 26.396 1.3223   0.22  
A1                     1 28.407 2.4552   0.04 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> drop1(mdb, test="permutation", permutations=per)
                      Df    AIC      F Pr(>F)  
<none>                   26.684                
Condition(Management)  2 27.240                
Manure                 3 26.396 1.3223   0.22  
A1                     1 28.407 2.4552   0.04 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> anova(mcca, permutations = per)
Permutation test for cca under reduced model
Permutation: free
Number of permutations: 49

Model: cca(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df ChiSquare      F Pr(>F)
Model     4   0.44962 1.2703   0.14
Residual 12   1.06181              
> anova(mrda, permutations = per)
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df Variance      F Pr(>F)
Model     4   16.791 1.3221   0.12
Residual 12   38.102              
> anova(mrda1, permutations = per)
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, scale = TRUE)
         Df Variance      F Pr(>F)
Model     4   6.1407 1.2217   0.14
Residual 12  15.0789              
> anova(mcap, permutations = per)
Permutation test for capscale under reduced model
Permutation: free
Number of permutations: 49

Model: capscale(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Model     4   1.0346 1.7282   0.08 .
Residual 12   1.7959                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mdb, permutations = per)
Permutation test for dbrda under reduced model
Permutation: free
Number of permutations: 49

Model: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Model     4   1.0346 1.7282   0.08 .
Residual 12   1.7959                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> anova(mcca, permutations = per, by="term")
Permutation test for cca under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 49

Model: cca(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df ChiSquare      F Pr(>F)  
Manure    3   0.27280 1.0277   0.40  
A1        1   0.17682 1.9983   0.04 *
Residual 12   1.06181                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mrda, permutations = per, by="term")
Permutation test for rda under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df Variance      F Pr(>F)
Manure    3   13.333 1.3997   0.12
A1        1    3.458 1.0892   0.38
Residual 12   38.102              
> anova(mrda1, permutations = per, by="term")
Permutation test for rda under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, scale = TRUE)
         Df Variance      F Pr(>F)
Manure    3   4.2797 1.1353   0.32
A1        1   1.8610 1.4810   0.10
Residual 12  15.0789              
> anova(mcap, permutations = per, by="term")
Permutation test for capscale under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 49

Model: capscale(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Manure    3  0.66713 1.4859   0.18  
A1        1  0.36743 2.4552   0.04 *
Residual 12  1.79587                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mdb, permutations = per, by="term")
Permutation test for dbrda under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 49

Model: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Manure    3  0.66713 1.4859   0.18  
A1        1  0.36743 2.4552   0.04 *
Residual 12  1.79587                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> anova(mcca, permutations = per, by="margin")
Permutation test for cca under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 49

Model: cca(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df ChiSquare      F Pr(>F)  
Manure    3   0.27368 1.0310   0.38  
A1        1   0.17682 1.9983   0.04 *
Residual 12   1.06181                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mrda, permutations = per, by="margin")
Permutation test for rda under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df Variance      F Pr(>F)
Manure    3   12.424 1.3043   0.16
A1        1    3.458 1.0892   0.38
Residual 12   38.102              
> anova(mrda1, permutations = per, by="margin")
Permutation test for rda under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, scale = TRUE)
         Df Variance     F Pr(>F)
Manure    3    4.211 1.117    0.3
A1        1    1.861 1.481    0.1
Residual 12   15.079             
> anova(mcap, permutations = per, by="margin")
Permutation test for capscale under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 49

Model: capscale(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Manure    3  0.59367 1.3223   0.22  
A1        1  0.36743 2.4552   0.04 *
Residual 12  1.79587                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mdb, permutations = per, by="margin")
Permutation test for dbrda under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 49

Model: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
Manure    3  0.59367 1.3223   0.22  
A1        1  0.36743 2.4552   0.04 *
Residual 12  1.79587                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> anova(mcca, permutations = per, by="axis")
Permutation test for cca under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 49

Model: cca(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df ChiSquare      F Pr(>F)  
CCA1      1   0.22257 2.5154   0.06 .
CCA2      1   0.12260 1.3855   0.44  
CCA3      1   0.06390 0.7222   0.88  
CCA4      1   0.04055 0.4583   1.00  
Residual 12   1.06181                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mrda, permutations = per, by="axis")
Permutation test for rda under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env)
         Df Variance      F Pr(>F)  
RDA1      1    8.539 2.6895   0.08 .
RDA2      1    4.330 1.3636   0.58  
RDA3      1    2.206 0.6948   0.94  
RDA4      1    1.716 0.5405   0.98  
Residual 12   38.102                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mrda1, permutations = per, by="axis")
Permutation test for rda under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 49

Model: rda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, scale = TRUE)
         Df Variance      F Pr(>F)  
RDA1      1   2.6117 2.0784   0.08 .
RDA2      1   1.6991 1.3521   0.38  
RDA3      1   1.1039 0.8785   0.84  
RDA4      1   0.7261 0.5778   1.00  
Residual 12  15.0789                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mcap, permutations = per, by="axis")
imaginary variation was discarded
Permutation test for capscale under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 49

Model: capscale(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
CAP1      1  0.67370 3.9998   0.06 .
CAP2      1  0.24300 1.4427   0.52  
CAP3      1  0.10457 0.6209   0.88  
CAP4      1  0.05136 0.3049   1.00  
Residual 12  2.02118                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> anova(mdb, permutations = per, by="axis")
Permutation test for dbrda under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 49

Model: dbrda(formula = dune ~ Condition(Management) + Manure + A1, data = dune.env, distance = "bray")
         Df SumOfSqs      F Pr(>F)  
dbRDA1    1  0.66660 4.4542   0.06 .
dbRDA2    1  0.23850 1.5936   0.50  
dbRDA3    1  0.09102 0.6082   0.86  
dbRDA4    1  0.03844 0.2569   1.00  
Residual 12  1.79587                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> ## the following do not work with partial models
> 
> mcca <- cca(dune ~ Management + Manure + A1, dune.env)
> mrda <- rda(dune ~ Management + Manure + A1, dune.env)
> mrda1 <- rda(dune ~ Management + Manure + A1, dune.env, scale = TRUE)
> mcap <- capscale(dune ~ Management + Manure + A1, dune.env, dist = "bray")
> mdb <- dbrda(dune ~ Management + Manure + A1, dune.env, dist = "bray")
> 
> head(calibrate(mcca))
  ManagementHF ManagementNM ManagementSF     Manure.L   Manure.Q    Manure.C
1   0.88360206  -0.17809052    0.3650012  0.792231508  0.7835459  0.57311529
2  -0.25759503  -0.06918216    0.4684124  0.217434240 -0.2708433  0.18995821
3  -0.05520592  -0.06841949    1.0403399  0.606094825  0.2172289  0.09595019
4  -0.30436889   0.13205353    1.2181418  0.591976882  0.7169519  0.40927504
5   0.96151990   0.09156902   -0.1249658 -0.002973172 -0.4935729 -0.11564392
6   1.44991911   0.07560224   -0.4229768 -0.053526651 -0.6857423 -0.40418186
        A1
1 1.302395
2 4.248246
3 4.228089
4 4.862963
5 4.964216
6 4.705495
> head(calibrate(mrda))
  ManagementHF ManagementNM ManagementSF   Manure.L    Manure.Q   Manure.C
1   0.29401062   0.40840280   0.44082761  0.3429410  0.96022808  0.2590732
2  -0.32193447  -0.21093999   0.52525780  0.2576090 -0.42643278  0.3208570
3  -0.06329046  -0.38255166   1.29556814  0.8881558  0.05105066  0.2084433
4  -0.23072016  -0.02585114   1.26360424  0.6662698  0.59228870  0.4811668
5   1.09410636   0.33361502  -0.08611898  0.1012246 -0.21872203 -0.4728422
6   1.54974463   0.12861025  -0.64747446 -0.2417242 -0.68891282 -0.2416285
        A1
1 3.136679
2 4.742654
3 3.024433
4 5.138888
5 5.690567
6 4.999154
> head(calibrate(mrda1))
  ManagementHF ManagementNM ManagementSF   Manure.L   Manure.Q    Manure.C
1  0.419517193   0.19560248   0.48993045  0.4089449  0.6367263  0.14413145
2 -0.255569668  -0.15994775   0.51242543  0.3396888 -0.3675106  0.09843765
3  0.008853507  -0.14992260   1.02376762  0.6594601  0.1947914  0.18454274
4 -0.428370700  -0.04567988   1.48630193  0.8289616  0.7720497  0.62000910
5  0.879122987   0.13238953  -0.06198182  0.0271789 -0.4332181 -0.20090501
6  1.594541234   0.09961208  -0.60111383 -0.2170851 -0.7731073 -0.32563540
        A1
1 3.245693
2 4.141507
3 3.849915
4 4.204391
5 4.883442
6 4.908019
> head(calibrate(mcap))
  ManagementHF ManagementNM ManagementSF   Manure.L    Manure.Q   Manure.C
1    0.3535056  0.129983997    0.7377202  0.8334587  1.15092777  0.3405095
2   -0.2732786 -0.180792603    0.5768840  0.3610840 -0.38954005  0.1133694
3   -0.1152079 -0.137879534    1.0762712  0.5049998  0.07824767  0.3354401
4   -0.2382976  0.007895537    1.1860086  0.5589081  0.37439201  0.2727337
5    1.0610154  0.425441235    0.1370962  0.2845974  0.04000862 -0.5996236
6    1.2179688  0.119875153   -0.5411688 -0.2679747 -0.68671004 -0.1856355
        A1
1 1.581889
2 4.561850
3 5.174177
4 4.543933
5 4.929796
6 4.778479
> head(calibrate(mdb))
  ManagementHF ManagementNM ManagementSF   Manure.L    Manure.Q   Manure.C
1    1.0594524   0.29232525    0.4530965  0.8716296  1.68674169  0.3909061
2   -0.3486990  -0.23103069    0.5714677  0.2706961 -0.48025948  0.2887174
3   -0.4731970  -0.16901804    1.2689487  0.5234851 -0.11917321  0.2571236
4   -0.5862554  -0.12330721    1.2779548  0.5022518  0.03599898  0.3006536
5    1.3326881   0.79709910    0.3159693  0.7026006  0.68493194 -1.3059834
6    1.0216997   0.04278981   -0.4544644 -0.1983255 -0.94646753 -0.4192565
         A1
1 0.8466514
2 4.7253689
3 5.7425320
4 4.7108166
5 5.0080680
6 4.8373560
> 
> head(calibrate(mcca, newdata=dune[11:15,]))
   ManagementHF ManagementNM ManagementSF   Manure.L   Manure.Q   Manure.C
11   0.23385788    0.1386086   -0.3258869 -0.6755254 -0.1065854  0.9630968
12  -0.26064234   -0.1331636    1.1715170 -0.1838604 -0.6938599  0.4684335
13  -0.08159412   -0.3085389    1.1809676  0.4649125 -0.6388093 -0.4728579
14  -0.50231584    1.0632584    0.1605969 -0.7984325  0.4151505 -0.1537859
15   0.55998130    0.9035392   -0.1598203 -0.5087195  0.6192600 -0.3627150
          A1
11  2.350688
12  5.987104
13  4.347945
14 12.320733
15 10.202581
> head(calibrate(mrda, newdata=dune[11:15,]))
   ManagementHF ManagementNM ManagementSF   Manure.L    Manure.Q     Manure.C
11   0.20198610    0.2813983  -0.26005972 -0.5730851  0.05235502  0.658255427
12  -0.32191652   -0.2512853   1.20833564 -0.1171094 -0.80402230  0.393613740
13  -0.03254595   -0.3945753   1.24945803  0.6222369 -0.68652009 -0.542291792
14  -0.35185974    0.9766868  -0.02111999 -0.8376043  0.39176064  0.009888821
15   0.29430797    1.0191806  -0.07277684 -0.5758965  0.63528205 -0.450474816
          A1
11  1.848909
12  4.467625
13  3.439140
14 12.396864
15  9.782752
> head(calibrate(mrda1, newdata=dune[11:15,]))
   ManagementHF ManagementNM ManagementSF   Manure.L    Manure.Q   Manure.C
11   0.15589029   0.25523066  -0.30220675 -0.7348754 -0.01331514  0.9093880
12  -0.21809455  -0.07205386   1.15067021 -0.1497826 -0.56425399  0.4281028
13  -0.04961517  -0.45841215   1.29278432  0.6675992 -0.78988471 -0.7279307
14  -0.23446421   1.03784941   0.02914171 -0.7549793  0.43517523 -0.2665248
15   0.29822077   1.00656888  -0.10298418 -0.6048887  0.61146065 -0.3657578
          A1
11  2.642516
12  5.967031
13  4.074723
14 11.937582
15 10.361506
> 
> 
> proc.time()
   user  system elapsed 
  2.434   0.101   2.542 
